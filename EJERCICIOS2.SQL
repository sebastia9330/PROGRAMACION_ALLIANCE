--Consulta: Encuentra el número de empleados que trabajan en cada oficina. Muestra el nombre de la ciudad de la oficina y 
--la cantidad de empleados en cada una.

SELECT OFICINA.CIUDAD, COUNT(*) AS NUMERO_EMPLEADOS
FROM EMPLEADO
JOIN OFICINA ON EMPLEADO.CODIGO_OFICINA = OFICINA.CODIGO_OFICINA
GROUP BY OFICINA.CIUDAD;

--Muestra los nombres de los productos y la diferencia entre su precio de venta y su precio del proveedor.
SELECT NOMBRE, (PRECIO_VENTA - PRECIO_PROVEEDOR) AS GANACIA
FROM PRODUCTO;

--Muestra los empleados que han gestionado más de 3 pedidos. Muestra su nombre, apellido y el número de pedidos que han gestionado.
SELECT E.CODIGO_EMPLEADO, E.NOMBRE, E.APELLIDO1, E.APELLIDO2, COUNT(P.CODIGO_PEDIDO) AS PEDIDOS_CONTADOS
FROM PEDIDO P
JOIN CLIENTE C ON P.CODIGO_CLIENTE = C.CODIGO_CLIENTE
JOIN EMPLEADO E ON C.CODIGO_EMPLEADO = E.CODIGO_EMPLEADO
GROUP BY E.CODIGO_EMPLEADO, E.NOMBRE, E.APELLIDO1, E.APELLIDO2
HAVING COUNT(P.CODIGO_PEDIDO) > 3;

--Encuentra los productos que han sido pedidos más de 10 veces y muestra su código de producto y el total de veces que han sido pedidos.
SELECT CODIGO_PRODUCTO, COUNT(*) AS VECES_PEDIDO
FROM DETALLE_PEDIDO
GROUP BY CODIGO_PRODUCTO
HAVING COUNT(*) = 2;


--SOLUCION PARA MOSTAR CANTIDADES Y NO CONTAR PEDIDOS
SELECT CODIGO_PRODUCTO, COUNT(CANTIDAD) AS CANTIDAD_COMPRADA
FROM DETALLE_PEDIDO
GROUP BY CODIGO_PRODUCTO
HAVING COUNT(CANTIDAD) < 9;

INSERT ALL 
    INTO CLIENTE(CODIGO_CLIENTE,NOMBRE_CLIENTE,NOMBRE_CONTACTO,APELLIDO_CONTACTO,TELEFONO,FAX,LINEA_DIRECCION1,LINEA_DIRECCION2,CIUDAD,REGION,PAIS,CODIGO_POSTAL,CODIGO_EMPLEADO,LIMITE_CREDITO) VALUES (1061,'Jose','Alfredo','jimenez','3245864033','9523456','Calle 75 #35-10','Calle 48 #20-82','Bogotá','Región Capital','Colombia','111921',NULL,515000)
SELECT * FROM dual;

-- Muestra los clientes que no han realizado ningún pedido. Muestra el código y nombre del cliente.
SELECT C.CODIGO_CLIENTE, C.NOMBRE_CLIENTE, C.APELLIDO_CONTACTO
FROM CLIENTE C
LEFT JOIN PEDIDO P ON C.CODIGO_CLIENTE = P.CODIGO_CLIENTE
WHERE P.CODIGO_PEDIDO IS NULL;

--Encuentra el producto con la cantidad más baja en stock y muestra su nombre y cantidad en stock.
SELECT nombre, cantidad_en_stock
FROM producto
ORDER BY cantidad_en_stock
FETCH FIRST 1 ROWS ONLY;

--OTRA MANERA MAS EFECTIVA
SELECT NOMBRE, CANTIDAD_EN_STOCK
FROM PRODUCTO
WHERE CANTIDAD_EN_STOCK = (
    SELECT MIN(CANTIDAD_EN_STOCK)
    FROM PRODUCTO
);