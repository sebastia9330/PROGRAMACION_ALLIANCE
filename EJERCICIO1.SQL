/*CREACION DE LA TABLA*/
CREATE TABLE Libros(
    ID_libro INT PRIMARY KEY,
    Titulo VARCHAR(50),
    Autor VARCHAR(50),
    Genero VARCHAR(50),
    Precio DECIMAL(10,2),
    Editorial VARCHAR(50),
    Año_publicacion VARCHAR(20)
);

/*INSERCCION DE LOS DATOS*/
INSERT ALL
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (1,'El señor de los Anillos','J.R.R. Tolkien','Fantasia',25.99,'Planeta','1954')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (2,'1984','George Orwel','Ciencia Ficcion',19.95,'Planeta','1949')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (3,'Orgullo y Prejucio','Jane Austen','Romance',15.75,'Planeta','1813')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (4,'El Alquimista','Paulo Coelho','Autoayuda',12.5,'Planeta','1988')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (5,'El Codigo Da Vinci','Dan Brown','Misterio',22.99,'Planeta','2003')
SELECT * FROM dual;

/*MOSTRAR SOLO LOS LIBROS DE CIENCIA FICCION*/
SELECT *
FROM libros
WHERE Genero = 'Ciencia Ficcion';

/*ORDENAR LOS LIBROS EN FORMA DESENDENTE POR EL PRECIO*/
SELECT *
FROM libros
ORDER BY Precio DESC;

/*SABER LA CANTIDAD DE LIBROS QUE TENGO*/
SELECT COUNT(*)
FROM libros;

/*ME CUENTA EL AUTOR QUE MAS LIBROS TIENE*/    
SELECT *
FROM (
  SELECT autor, COUNT(*) AS numero_libros
  FROM libros
  GROUP BY autor
  ORDER BY numero_libros DESC
)
WHERE ROWNUM = 1;

/*INSERTAR UN SOLO REGISTRO*/
INSERT INTO libros VALUES (6,'Inferno','Dan Brown','Misterio',20.95,'Planeta','2008');

/*MOSTRAR TODOS LOS REGISTROS*/
SELECT *
FROM libros;

/*ME MUESTRA EL PROMEDIO DE LOS PRECIOS PARA EL GENERO FANTASIA*/
SELECT AVG(precio) FROM libros WHERE genero = 'fantasía';


INSERT ALL
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (001,'BOGOTA','Colombia','REGION CENTRAL','110111','3114567890','Calle 45 # 10-20','Calle 24 # 14-10') 
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (002,'MEDELLIN','Colombia','REGION ANTIOQUIA','500001','3115678940','Avenida 70 # 43-25','Avenida 52 # 24-15')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (003,'CALI','Colombia','REGION PACIFICO','760001','3116789450','Carrera 12 # 5-30','Carrera 15 # 8-12')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (004,'BARRANQUILLA','Colombia','REGION CARIBE','801200','3117890456','Calle 58 # 30-15','Calle 77 # 28-50')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (005,'ARAUCA','Colombia','REGION ORINOQUIA','810001','3118094567','Carrera 8 # 6-22','Carrera 3 # 7-18')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1001,'Ana','Garcia','Torres','1001','ana_123@ferreteia.com',001,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1002,'Javier','Rodriguez','Ramírez','1002','javier_456@ferreteia.com',002,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1003,'Laura','Martínez','Herrera','1003','laura_789@ferreteia.com',003,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1004,'Andrés','López','Mendoza','1004','andres_234@ferreteia.com',004,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1005,'María','Pérez','Soto','1005','maria_567@ferreteia.com',005,'Vendedor en Linea')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1006,'Daniel','Gómez','Silva','1006','daniel_890@ferreteia.com',001,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1007,'Carolina','Fernández','Castro','1007','carolina_345@ferreteia.com',002,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1008,'Sergio','González','Ruiz','1008','sergio_678@ferreteia.com',003,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1009,'Isabel','Moreno','Cordero','1009','isabel_901@ferreteia.com',004,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1010,'Manuel','Jiménez','Delgado','1010','manuel_234@ferreteia.com',005,'Vendedor en Oficina')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1011,'Claudia','Díaz','Romero','1011','claudia_567@ferreteia.com',001,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1012,'Luis','Vargas','Vargas','1012','luis_890@ferreteia.com',002,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1013,'Paula','Castillo','Molina','1013','paula_123@ferreteia.com',003,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1014,'Felipe','Morales','Paredes','1014','felipe_456@ferreteia.com',004,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1015,'Valentina','Ortega','Delgado','1015','valentina_789@ferreteia.com',005,'Vendedor en Linea')
SELECT * FROM dual;

INSERT ALL
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1001, 'Electrónico', '08/01/24', 150000.00, 'FACT0001')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1002, 'Efectivo', NULL, 155000.00, 'FACT0002')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1003, 'Electrónico', NULL, 176000, 'FACT0003')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1004, 'Efectivo', NULL, 216000, 'FACT0004')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1005, 'Electrónico', '14/01/24', 90000, 'FACT0005')
SELECT * FROM dual;


INSERT ALL
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1006,'Efectivo','16/01/24',96000,'FACT0006')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1007,'Electronico','16/01/24',135000,'FACT0007')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1008,'Efectivo',NULL,15000,'FACT0008')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1009,'Electronico','24/01/24',30000,'FACT0009')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1010,'Efectivo','16/01/24',45000,'FACT0010')
SELECT * FROM dual;


INSERT ALL
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1011,'Electrónico', NULL,750000,'FACT0011')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1012,'Efectivo','27/01/24',33000,'FACT0012') 
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1013,'Electrónico','27/01/24',150000,'FACT0013')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1014,'Efectivo',NULL,140000,'FACT0014')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1015,'Electrónico',NULL,431500,'FACT0015')
SELECT * FROM dual;

INSERT ALL
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1016,'Efectivo','12/01/24',24000,'FACT0020')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1017,'Electronico','14/01/24',32000,'FACT0021')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1018,'Efectivo',NULL,450000,'FACT0022')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1019,'Electronico',NULL,125000,'FACT0023')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1020,'Efectivo',NULL,220000,'FACT0024')
SELECT * FROM dual;

INSERT ALL
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1021,'Efectivo','06/03/24',72000,'FACT0016')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1022,'Electrónico','06/03/24',417000,'FACT0017')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1023,'Electrónico',NULL,48000,'FACT0018')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1024,'Efectivo','08/03/24',36000,'FACT0019')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1025,'Electrónico','08/03/24',140000,'FACT0025')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1026,'Efectivo','08/03/24',70000,'FACT0026')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1027,'Electronico',NULL,64000,'FACT0027')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1028,'Efectivo',NULL,134000,'FACT0028')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1029,'Electronico','07/04/2024',700000,'FACT0029')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1030,'Efectivo','07/04/24',50000,'FACT0030')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1031,'Efectivo','07/04/24',27500,'FACT0031')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1032,'Electrónico',NULL,96000,'FACT0032')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1033,'Electrónico','15/04/24',77500,'FACT0033')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1034,'Efectivo','15/04/24',150000,'FACT0034')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1035,'Electrónico',NULL,36000,'FACT0035')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1036,'Efectivo',NULL,72000,'FACT0036')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1037,'Electronico',NULL,108000,'FACT0037')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1038,'Efectivo','10/05/24',240000,'FACT0038')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1039,'Electronico','17/05/24',110000,'FACT0039')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1040,'Efectivo','17/05/24',56000,'FACT0040')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1041,'Efectivo',NULL,166000,'FACT0041')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1042,'Electrónico','07/06/24',200000,'FACT0042')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1043,'Electrónico','07/06/24',84000,'FACT0043')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1044,'Efectivo','07/06/24',72000,'FACT0044')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1045,'Electrónico',NULL,252000,'FACT0045')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1046,'Efectivo',NULL,40000,'FACT0046')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1047,'Electronico','07/07/24',1260000,'FACT0047')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1048,'Efectivo','07/07/24',1300000,'FACT0048')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1049,'Electronico','07/07/24',36000,'FACT0049')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1050,'Efectivo',NULL,32000,'FACT0050')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1051,'Efectivo',NULL,40000,'FACT0051')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1052,'Electrónico',NULL,72000,'FACT0052')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1053,'Electrónico','06/08/24',1080000,'FACT0053')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1054,'Efectivo','07/08/24',120000,'FACT0054')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1055,'Electrónico','07/08/24',10000,'FACT0055')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1056,'Efectivo',NULL,130000,'FACT0056')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1057,'Electronico',NULL,64000,'FACT0057')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1058,'Efectivo','17/08/24',300000,'FACT0058')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1059,'Electronico','17/08/24',40000,'FACT0059')
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1060,'Efectivo',NULL,84000,'FACT0060')
SELECT * FROM dual;