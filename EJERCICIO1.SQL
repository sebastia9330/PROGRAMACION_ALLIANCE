/*CREACION DE LA TABLA*/
CREATE TABLE Libros(
    ID_libro INT PRIMARY KEY,
    Titulo VARCHAR(50),
    Autor VARCHAR(50),
    Genero VARCHAR(50),
    Precio DECIMAL(10,2),
    Editorial VARCHAR(50),
    Año_publicacion VARCHAR(20)
);

/*INSERCCION DE LOS DATOS*/
INSERT ALL
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (1,'El señor de los Anillos','J.R.R. Tolkien','Fantasia',25.99,'Planeta','1954')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (2,'1984','George Orwel','Ciencia Ficcion',19.95,'Planeta','1949')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (3,'Orgullo y Prejucio','Jane Austen','Romance',15.75,'Planeta','1813')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (4,'El Alquimista','Paulo Coelho','Autoayuda',12.5,'Planeta','1988')
    INTO libros(ID_libro,Titulo,Autor,Genero,Precio,Editorial,Año_publicacion) VALUES (5,'El Codigo Da Vinci','Dan Brown','Misterio',22.99,'Planeta','2003')
SELECT * FROM dual;

/*MOSTRAR SOLO LOS LIBROS DE CIENCIA FICCION*/
SELECT *
FROM libros
WHERE Genero = 'Ciencia Ficcion';

/*ORDENAR LOS LIBROS EN FORMA DESENDENTE POR EL PRECIO*/
SELECT *
FROM libros
ORDER BY Precio DESC;

/*SABER LA CANTIDAD DE LIBROS QUE TENGO*/
SELECT COUNT(*)
FROM libros;

/*ME CUENTA EL AUTOR QUE MAS LIBROS TIENE*/    
SELECT *
FROM (
  SELECT autor, COUNT(*) AS numero_libros
  FROM libros
  GROUP BY autor
  ORDER BY numero_libros DESC
)
WHERE ROWNUM = 1;

/*INSERTAR UN SOLO REGISTRO*/
INSERT INTO libros VALUES (6,'Inferno','Dan Brown','Misterio',20.95,'Planeta','2008');

/*MOSTRAR TODOS LOS REGISTROS*/
SELECT *
FROM libros;

/*ME MUESTRA EL PROMEDIO DE LOS PRECIOS PARA EL GENERO FANTASIA*/
SELECT AVG(precio) FROM libros WHERE genero = 'fantasía';


INSERT ALL
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (001,'BOGOTA','Colombia','REGION CENTRAL','110111','3114567890','Calle 45 # 10-20','Calle 24 # 14-10') 
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (002,'MEDELLIN','Colombia','REGION ANTIOQUIA','500001','3115678940','Avenida 70 # 43-25','Avenida 52 # 24-15')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (003,'CALI','Colombia','REGION PACIFICO','760001','3116789450','Carrera 12 # 5-30','Carrera 15 # 8-12')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (004,'BARRANQUILLA','Colombia','REGION CARIBE','801200','3117890456','Calle 58 # 30-15','Calle 77 # 28-50')
    INTO OFICINA(CODIGO_OFICINA,CIUDAD,PAIS,REGION,CODIGO_POSTAL,TELEFONO,LINEA_DIRECCION1,LINEA_DIRECCION2) VALUES (005,'ARAUCA','Colombia','REGION ORINOQUIA','810001','3118094567','Carrera 8 # 6-22','Carrera 3 # 7-18')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1001,'Ana','Garcia','Torres','1001','ana_123@ferreteia.com',001,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1002,'Javier','Rodriguez','Ramírez','1002','javier_456@ferreteia.com',002,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1003,'Laura','Martínez','Herrera','1003','laura_789@ferreteia.com',003,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1004,'Andrés','López','Mendoza','1004','andres_234@ferreteia.com',004,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1005,'María','Pérez','Soto','1005','maria_567@ferreteia.com',005,'Vendedor en Linea')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1006,'Daniel','Gómez','Silva','1006','daniel_890@ferreteia.com',001,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1007,'Carolina','Fernández','Castro','1007','carolina_345@ferreteia.com',002,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1008,'Sergio','González','Ruiz','1008','sergio_678@ferreteia.com',003,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1009,'Isabel','Moreno','Cordero','1009','isabel_901@ferreteia.com',004,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1010,'Manuel','Jiménez','Delgado','1010','manuel_234@ferreteia.com',005,'Vendedor en Oficina')
SELECT * FROM dual;

INSERT ALL
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1011,'Claudia','Díaz','Romero','1011','claudia_567@ferreteia.com',001,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1012,'Luis','Vargas','Vargas','1012','luis_890@ferreteia.com',002,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1013,'Paula','Castillo','Molina','1013','paula_123@ferreteia.com',003,'Vendedor en Linea')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1014,'Felipe','Morales','Paredes','1014','felipe_456@ferreteia.com',004,'Vendedor en Oficina')
    INTO EMPLEADO(CODIGO_EMPLEADO,NOMBRE,APELLIDO1,APELLIDO2,EXTENSION,EMAIL,CODIGO_OFICINA,PUESTO) VALUES (1015,'Valentina','Ortega','Delgado','1015','valentina_789@ferreteia.com',005,'Vendedor en Linea')
SELECT * FROM dual;

INSERT ALL
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1001, 'Electrónico', '08/01/24', 150000.00, 'FACT0001')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1002, 'Efectivo', NULL, 155000.00, 'FACT0002')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1003, 'Electrónico', NULL, 176000, 'FACT0003')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1004, 'Efectivo', NULL, 216000, 'FACT0004')
    INTO PAGO(CODIGO_CLIENTE, FORMA_PAGO, FECHA_PAGO, TOTAL, ID_TRANSACCION) VALUES (1005, 'Electrónico', '14/01/24', 90000, 'FACT0005')
SELECT * FROM dual;


INSERT ALL
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1006,'Efectivo','16/01/24',96000)
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1007,'Electronico','16/01/24',135000)
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1008,'Efectivo',NULL,15000)
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1009,'Electronico','24/01/24',30000)
    INTO PAGO(CODIGO_CLIENTE,FORMA_PAGO,FECHA_PAGO,TOTAL,ID_TRANSACCION) VALUES (1010,'Efectivo','16/01/24',45000)
SELECT * FROM dual;


